<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ ¡åœ’ç¶²è·¯åŠèª²ç¨‹æœå‹™å›å ±ç³»çµ±</title>
    <style>
        :root { 
            --primary-color: #2563eb; 
            --bg-color: #f1f5f9; 
            --text-dark: #1e293b;
            --accent-red: #dc2626;
        }
        body { 
            font-family: -apple-system, "Noto Sans TC", sans-serif; 
            background: var(--bg-color); 
            margin: 0; padding: 15px; display: flex; justify-content: center; align-items: center; min-height: 100vh; 
        }
        .container { 
            width: 100%; max-width: 420px; background: white; 
            padding: 35px 20px; border-radius: 20px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.08); 
        }
        h2 { text-align: center; color: var(--text-dark); margin-bottom: 12px; font-weight: 800; font-size: 26px; }
        .subtitle { font-size: 15px; color: #64748b; margin-bottom: 30px; line-height: 1.8; text-align: center; font-weight: 500; }
        
        .field-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 10px; font-size: 17px; color: var(--text-dark); font-weight: 700; }
        input, select, textarea { 
            width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 12px; 
            font-size: 16px; box-sizing: border-box; transition: 0.3s; background: #fff;
        }
        input:focus, select:focus, textarea:focus { 
            border-color: var(--primary-color); outline: none; box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1); 
        }

        .hint-box {
            display: none; margin-top: 10px; padding: 12px; background-color: #f8fafc;
            border-left: 4px solid var(--primary-color); border-radius: 8px; font-size: 13px; color: #475569; line-height: 1.6;
        }
        .text-red { color: var(--accent-red); font-weight: bold; }
        .wifi-link { color: var(--primary-color); text-decoration: underline; font-weight: 600; }

        .email-group { display: flex; align-items: stretch; }
        .email-group input { flex: 1; border-top-right-radius: 0; border-bottom-right-radius: 0; margin-bottom: 0; min-width: 0; }
        .email-suffix { background: #f8fafc; padding: 0 12px; border: 2px solid #e2e8f0; border-left: none; border-radius: 0 12px 12px 0; display: flex; align-items: center; font-weight: 600; color: #64748b; font-size: 13px; white-space: nowrap; }
        
        .cond-field { display: none; }
        
        .btn-submit { width: 100%; background: var(--primary-color); color: white; border: none; padding: 18px; border-radius: 12px; font-size: 19px; font-weight: bold; cursor: pointer; margin-top: 15px; }
        .btn-submit:disabled { background: #94a3b8; cursor: not-allowed; }
        .loading { display: none; text-align: center; color: var(--primary-color); margin-top: 15px; font-weight: 600; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ›  æ ¡åœ’ç¶²è·¯åŠèª²ç¨‹æœå‹™å›å ±å–®</h2>
    <p class="subtitle">æä¾›ç¶²è·¯åŠ TronClass å¹³å°å›å ±<br>è«‹å¡«å¯«ä¸‹åˆ—è³‡è¨Šï¼Œæˆ‘å€‘å°‡å„˜é€Ÿè™•ç†</p>
    
    <div class="field-group">
        <label>ğŸ“‚ å•é¡Œé¡å‹</label>
        <select id="category" onchange="updateFields()">
            <option value="æ ¡åœ’æœ‰ç·šç¶²è·¯">æ ¡åœ’æœ‰ç·šç¶²è·¯</option>
            <option value="WI-FI">WI-FI æ ¡åœ’ç„¡ç·šç¶²è·¯</option>
            <option value="TronClass">TronClass æ•™å­¸å¹³å°</option>
            <option value="å…¶ä»–">å…¶ä»–</option>
        </select>
        <div id="wifi-info" class="hint-box">
            æ ¡åœ’ç„¡ç·šç¶²è·¯åç¨±ç‚º <span class="text-red">ntou</span> æˆ– <span class="text-red">ntou-802.1X</span>ï¼Œé™¤æ­¤ä»¥å¤–è«‹è‡³é„°è¿‘ç³»è¾¦è©¢å•ã€‚èªªæ˜è«‹è¦‹ <a href="https://li.ntou.edu.tw/p/412-1029-7181.php?Lang=zh-tw" target="_blank" class="wifi-link">æ ¡åœ’ç„¡ç·šç¶²è·¯</a>ã€‚
        </div>
    </div>

    <div class="field-group">
        <label>ğŸ‘¤ å§“å</label>
        <input type="text" id="name" placeholder="æ‚¨çš„å®Œæ•´å§“å">
    </div>

    <div id="sid-box" class="field-group cond-field">
        <label>ğŸ†” å­¸è™Ÿ / è·å“¡è­‰è™Ÿ</label>
        <input type="text" id="studentId" placeholder="è«‹è¼¸å…¥ç·¨è™Ÿ">
    </div>

    <div class="field-group">
        <label>ğŸ“ è¯çµ¡é›»è©±</label>
        <input type="tel" id="phone" placeholder="æ‰‹æ©Ÿæˆ–åˆ†æ©Ÿ">
    </div>

    <div class="field-group">
        <label>âœ‰ï¸ é›»å­éƒµä»¶</label>
        <div class="email-group">
            <input type="text" id="email_user" placeholder="è¼¸å…¥å¸³è™Ÿ">
            <div class="email-suffix">@mail.ntou.edu.tw</div>
        </div>
    </div>

    <div id="loc-box" class="field-group cond-field">
        <label>ğŸ¢ å•é¡Œåœ°é»</label>
        <input type="text" id="location" placeholder="ä¾‹å¦‚ï¼šè¡Œæ”¿å¤§æ¨“ 2F">
    </div>

    <div class="field-group">
        <label>ğŸ“ å•é¡Œå…·é«”æè¿°</label>
        <div id="wired-info" class="hint-box" style="margin-bottom: 10px;">
            âš ï¸ å‹™å¿…å‘ŠçŸ¥ IP (140.121.xxx.xxx) æˆ–è©³è¿°æ‰€åœ¨åœ°é»ä¹‹è³‡è¨Šã€‚
        </div>
        <textarea id="note" rows="6" placeholder="è«‹å¡«å¯«å…·é«”æƒ…æ³..."></textarea>
    </div>

    <button id="submitBtn" class="btn-submit" onclick="submitToGoogleForm()">é€å‡ºå›å ±å–®</button>
    <div id="loading" class="loading">â³ å‚³é€ä¸­ï¼Œè«‹ç¨å€™...</div>
</div>

<iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>

<script>
    window.onload = function() { updateFields(); };

    function updateFields() {
        const cat = document.getElementById('category').value;
        const sidBox = document.getElementById('sid-box');
        const locBox = document.getElementById('loc-box');
        const wifiInfo = document.getElementById('wifi-info');
        const wiredInfo = document.getElementById('wired-info');
        const noteArea = document.getElementById('note');

        sidBox.style.display = (cat === "TronClass") ? 'block' : 'none';
        locBox.style.display = (cat === "WI-FI") ? 'block' : 'none';
        wifiInfo.style.display = (cat === "WI-FI") ? 'block' : 'none';
        wiredInfo.style.display = (cat === "æ ¡åœ’æœ‰ç·šç¶²è·¯") ? 'block' : 'none';

        noteArea.value = ""; 
    }

    function submitToGoogleForm() {
        const btn = document.getElementById('submitBtn');
        const loading = document.getElementById('loading');
        const formID = "1FAIpQLSfwPegQCOBOonrEFRnlgdUlo4UtfAtqYVww55thhSvRgho5mQ";
        const actionURL = `https://docs.google.com/forms/d/e/${formID}/formResponse`;

        const cat = document.getElementById('category').value;
        const name = document.getElementById('name').value.trim();
        const phone = document.getElementById('phone').value.trim();
        const emailUser = document.getElementById('email_user').value.trim();
        const location = document.getElementById('location').value.trim();
        const note = document.getElementById('note').value.trim();

        if (!name || !phone || !note || !emailUser) {
            alert("è«‹å‹™å¿…å®Œæ•´å¡«å¯«æ‰€æœ‰æ¬„ä½");
            return;
        }

        btn.disabled = true;
        loading.style.display = 'block';

        const form = document.createElement('form');
        form.action = actionURL;
        form.method = 'POST';
        form.target = 'hidden_iframe';

        let finalNote = note;
        if (cat === "WI-FI") {
            finalNote = `ã€å•é¡Œåœ°é»ï¼š${location}ã€‘\n${note}`;
        }

        const data = {
            "entry.1515724942": cat,
            "entry.1710680189": name,
            "entry.1684857821": document.getElementById('studentId').value.trim(),
            "entry.498053581": phone,
            "entry.2029585950": emailUser + "@mail.ntou.edu.tw",
            "entry.1300025129": finalNote
        };

        for (let key in data) {
            const input = document.createElement('input');
            input.type = 'hidden';
            input.name = key;
            input.value = data[key];
            form.appendChild(input);
        }

        document.body.appendChild(form);
        form.submit();
        document.body.removeChild(form);

        setTimeout(() => {
            alert("âœ… å›å ±æˆåŠŸï¼æˆ‘å€‘å°‡å„˜é€Ÿç‚ºæ‚¨è™•ç†ã€‚");
            window.location.reload();
        }, 1500);
    }
</script>
</body>
</html>