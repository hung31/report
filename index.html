<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ ¡åœ’ç¶²è·¯åŠèª²ç¨‹æœå‹™å›å ±ç³»çµ±</title>
    <style>
        :root { 
            --primary-color: #2563eb; 
            --primary-dark: #1e40af;
            --title-color: #0f172a; 
            --bg-color: #f8fafc; 
            --text-dark: #1e293b;
            --text-light: #64748b;
            --accent-red: #dc2626;
            --border-color: #e2e8f0;
        }

        body { 
            font-family: -apple-system, "Segoe UI", "Noto Sans TC", sans-serif; 
            background: var(--bg-color); 
            margin: 0; padding: 15px; display: flex; justify-content: center; align-items: center; min-height: 100vh; 
            color: var(--text-dark);
        }

        .container { 
            width: 100%; max-width: 420px; background: white; 
            padding: 30px 20px 40px 20px; border-radius: 24px; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.06); 
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.8);
        }

        .container::before {
            content: "";
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 6px;
            background: linear-gradient(90deg, var(--primary-color), var(--primary-dark));
        }

        .header-section {
            text-align: center;
            margin-bottom: 25px;
        }

        .header-icon {
            width: 54px; height: 54px;
            background: #dbeafe; 
            border: 2px solid #bfdbfe;
            border-radius: 16px;
            display: flex; align-items: center; justify-content: center;
            margin: 10px auto 12px;
            color: var(--primary-dark);
        }

        h2 { 
            margin: 0; font-size: 24px; font-weight: 900; letter-spacing: -0.5px; color: var(--title-color); 
        }

        .subtitle { 
            font-size: 14px; color: var(--text-light); margin-top: 8px; line-height: 1.5; font-weight: 500; 
        }
        
        .field-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-size: 16px; color: var(--text-dark); font-weight: 700; }
        
        .ip-warning { 
            color: var(--accent-red); font-weight: bold; font-size: 13px; 
            margin-bottom: 10px; display: none; line-height: 1.4;
            background: #fff1f2; padding: 10px; border-radius: 8px; border: 1px solid #fecaca;
        }

        input, select, textarea { 
            width: 100%; padding: 14px; border: 2px solid var(--border-color); border-radius: 12px; 
            font-size: 16px; box-sizing: border-box; transition: 0.3s; background: #fff; color: var(--text-dark);
        }
        input:focus, select:focus, textarea:focus { 
            border-color: var(--primary-color); outline: none; box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1); 
        }

        .hint-box {
            display: none; margin-top: 10px; padding: 10px 12px; background-color: #f8fafc;
            border-left: 4px solid var(--primary-color); border-radius: 8px; 
            font-size: 13px; color: #475569; line-height: 1.6;
        }
        .wifi-link { color: var(--primary-color); text-decoration: underline; font-weight: 700; white-space: nowrap; }

        .email-group { display: flex; align-items: stretch; }
        .email-group input { flex: 1; border-top-right-radius: 0; border-bottom-right-radius: 0; margin-bottom: 0; min-width: 0; }
        
        .email-suffix { 
            background: #f1f5f9; 
            padding: 0 15px; 
            border: 2px solid var(--border-color); 
            border-left: none; 
            border-radius: 0 12px 12px 0; 
            display: flex; 
            align-items: center; 
            font-weight: 700; 
            color: var(--text-dark); 
            font-size: 15px; 
            white-space: nowrap; 
        }
        
        .cond-field { display: none; }
        
        .btn-submit { 
            width: 100%; background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            color: white; border: none; padding: 16px; border-radius: 12px; 
            font-size: 18px; font-weight: bold; cursor: pointer; margin-top: 10px;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2); transition: 0.2s;
        }
        .btn-submit:active { transform: scale(0.98); }
        .btn-submit:disabled { background: #cbd5e1; cursor: not-allowed; box-shadow: none; }
        
        .loading { display: none; text-align: center; color: var(--primary-color); margin-top: 15px; font-weight: 600; font-size: 14px; }

        /* ä¿®æ”¹å¾Œçš„æ·ºè‰²å½ˆçª—æ¨£å¼ */
        #success-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.7); /* æ·ºè‰²é€æ˜èƒŒæ™¯ */
            z-index: 1000; justify-content: center; align-items: center; 
            backdrop-filter: blur(8px); /* ç£¨ç ‚ç»ç’ƒæ•ˆæœ */
        }
        .modal-content {
            background: #ffffff; 
            padding: 35px 25px; 
            border-radius: 24px; 
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15); 
            max-width: 280px; 
            width: 80%;
            border: 1px solid var(--border-color);
        }
        .modal-content h3 { 
            font-size: 24px; 
            color: #059669; /* æˆåŠŸç¶ è‰² */
            margin: 0 0 12px 0; 
            font-weight: 800; 
        }
        .modal-content p { 
            font-size: 16px; 
            color: var(--text-dark); 
            margin: 0; 
            line-height: 1.6; 
            font-weight: 500;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header-section">
        <div class="header-icon">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <rect x="2" y="2" width="20" height="8" rx="2" ry="2"></rect>
                <rect x="2" y="14" width="20" height="8" rx="2" ry="2"></rect>
                <line x1="6" y1="6" x2="6.01" y2="6"></line>
                <line x1="6" y1="18" x2="6.01" y2="18"></line>
            </svg>
        </div>
        <h2>æ ¡åœ’ç¶²è·¯åŠèª²ç¨‹æœå‹™å›å ±å–®</h2>
        <p class="subtitle">è‹¥æœ‰ç¶²è·¯æˆ– TronClass ä½¿ç”¨å•é¡Œ<br>è«‹å¡«å¯«ä¸‹æ–¹è³‡è¨Šï¼Œæˆ‘å€‘å°‡å„˜é€Ÿè™•ç†</p>
    </div>
    
    <div class="field-group">
        <label>ğŸ“‚ å•é¡Œé¡å‹</label>
        <select id="category" onchange="updateFields()">
            <option value="æ ¡åœ’ç¶²è·¯åŠ WI-FI">æ ¡åœ’ç¶²è·¯åŠ WI-FI</option>
            <option value="TronClass">TronClass æ•™å­¸å¹³å°</option>
        </select>
        <div id="wifi-info" class="hint-box">
            ğŸ“¶ æ ¡åœ’ç„¡ç·šç¶²è·¯åç¨±ç‚º <b>ntou</b> æˆ– <b>ntou-802.1X</b>ï¼Œç™»å…¥æ–¹å¼è«‹è¦‹ <a href="https://li.ntou.edu.tw/p/412-1029-7181.php?Lang=zh-tw" target="_blank" class="wifi-link">å®˜æ–¹èªªæ˜</a>ã€‚
        </div>
    </div>

    <div class="field-group">
        <label>ğŸ‘¤ å§“å</label>
        <input type="text" id="name" placeholder="æ‚¨çš„å®Œæ•´å§“å">
    </div>

    <div id="sid-box" class="field-group cond-field">
        <label>ğŸ†” å­¸è™Ÿ / è·å“¡è­‰è™Ÿ</label>
        <input type="text" id="studentId" placeholder="è«‹è¼¸å…¥ç·¨è™Ÿ">
    </div>

    <div class="field-group">
        <label>ğŸ“ è¯çµ¡é›»è©±</label>
        <input type="tel" id="phone" placeholder="æ‰‹æ©Ÿæˆ–åˆ†æ©Ÿè™Ÿç¢¼">
    </div>

    <div class="field-group">
        <label>âœ‰ï¸ é›»å­éƒµä»¶</label>
        <div class="email-group">
            <input type="text" id="email_user" placeholder="è¼¸å…¥å¸³è™Ÿ">
            <div class="email-suffix">@mail.ntou.edu.tw</div>
        </div>
    </div>

    <div class="field-group">
        <label>ğŸ“ å•é¡Œå…·é«”æè¿°</label>
        <div id="ip-warning" class="ip-warning">
            âš ï¸ å‹™å¿…å‘ŠçŸ¥ IP (140.121.xxx.xxx) æˆ–è©³è¿°æ‰€åœ¨åœ°é»ä¹‹è³‡è¨Šã€‚
        </div>
        <textarea id="note" rows="5" placeholder="è«‹å¡«å¯«å…·é«”æƒ…æ³..."></textarea>
    </div>

    <button id="submitBtn" class="btn-submit" onclick="submitToGoogleForm()">é€å‡ºå›å ±å–®</button>
    <div id="loading" class="loading">â³ æ­£åœ¨å‚³é€å›å ±å–®...</div>
</div>

<div id="success-modal">
    <div class="modal-content">
        <h3>âœ… å›å ±æˆåŠŸï¼</h3>
        <p>æ„Ÿè¬æ‚¨çš„åæ˜ <br>ç³»çµ±å°‡å„˜é€Ÿç‚ºæ‚¨è™•ç†</p>
    </div>
</div>

<iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>

<script>
    window.onload = function() { updateFields(); };

    function updateFields() {
        const cat = document.getElementById('category').value;
        const sidBox = document.getElementById('sid-box');
        const wifiInfo = document.getElementById('wifi-info');
        const ipWarning = document.getElementById('ip-warning');

        if (cat === "æ ¡åœ’ç¶²è·¯åŠ WI-FI") {
            sidBox.style.display = 'none';
            wifiInfo.style.display = 'block';
            ipWarning.style.display = 'block';
        } else {
            sidBox.style.display = 'block';
            wifiInfo.style.display = 'none';
            ipWarning.style.display = 'none';
        }
        document.getElementById('note').value = ""; 
    }

    function submitToGoogleForm() {
        const btn = document.getElementById('submitBtn');
        const loading = document.getElementById('loading');
        const modal = document.getElementById('success-modal');
        const formID = "1FAIpQLSfwPegQCOBOonrEFRnlgdUlo4UtfAtqYVww55thhSvRgho5mQ";

        const cat = document.getElementById('category').value;
        const name = document.getElementById('name').value.trim();
        const phone = document.getElementById('phone').value.trim();
        const emailUser = document.getElementById('email_user').value.trim();
        const note = document.getElementById('note').value.trim();

        if (!name || !phone || !note || !emailUser) {
            alert("è«‹å‹™å¿…å®Œæ•´å¡«å¯«æ‰€æœ‰æ¬„ä½");
            return;
        }

        btn.disabled = true;
        loading.style.display = 'block';

        const form = document.createElement('form');
        form.action = `https://docs.google.com/forms/d/e/${formID}/formResponse`;
        form.method = 'POST';
        form.target = 'hidden_iframe';

        const data = {
            "entry.1515724942": cat,
            "entry.1710680189": name,
            "entry.1964757819": document.getElementById('studentId').value.trim(),
            "entry.1684857821": phone,
            "entry.498053581": emailUser + "@mail.ntou.edu.tw",
            "entry.1300025129": note
        };

        for (let key in data) {
            const input = document.createElement('input');
            input.type = 'hidden'; input.name = key; input.value = data[key];
            form.appendChild(input);
        }

        document.body.appendChild(form);
        form.submit();
        document.body.removeChild(form);

        setTimeout(() => {
            loading.style.display = 'none';
            modal.style.display = 'flex'; 
            setTimeout(() => { window.location.reload(); }, 2800);
        }, 1500);
    }
</script>
</body>
</html>